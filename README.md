# DWR Publication Classification Preparation

This repo contains code used to prepare DWR manuscript data for classification by discipline and subject matter. Specifically, this repo houses R scripts for processing publication DOIs and generating RIS citation files that include abstracts. It includes two main workflows:

1. **Generate RIS file:**  
   A script that reads a text file containing DOIs and creates a basic RIS file
   with minimal citation fields. It also logs any errors that indicate that the
   DOI is invalid.  
   **Script:** [01_generate_ris.R](01_generate_ris.R)

2. **Enrich RIS with abstracts:**  
   A script that reads the previously generated RIS file, retrieves publication
   abstracts from the [Crossref API](https://www.crossref.org/documentation/retrieve-metadata/rest-api/),
   and appends them to the RIS records. It also logs any errors or cases where
   no abstract is available.  
   **Script:** [02_pull_abstracts.R](02_pull_abstracts.R)

*Note: the input and output documents currently in this repository are meant to*
*illustrate the workflow and should not be used as final products.*

## Known errors

Errors can be observed in the error logs generated by each script. Currently,
known errors are:

1. **Incorrect DOIs:** if DOIs contain typos or are otherwise incorrect, the 
   workflow will fail to pull citation information and abstracts for them. The
   incorrect DOIs are logged in the [DOI error log](doi_error_log.csv) produced by
   the [first script](01_generate_ris.R) in the pipeline.

2. **API does not pull abstracts:** for a minority of publications (perhaps 15%
   to 20%), the [Crossref API](https://www.crossref.org/documentation/retrieve-metadata/rest-api/)
   does not return an abstract. This is an issue with the way that scientific 
   journals and Crossref interact and is a challenge that cannot be solved with
   automation. For this subset of publications, logged in the [abstract error log](abstract_error_log.csv)
   produced by the [second script](02_pull_abstracts.R) in the pipeline,
   abstracts will need to be manually added. It is possible to produce a script
   to support manual elements of the workflow, but that script does not exist yet.


## Requirements

The scripts use R and the following packages:
- [here](https://cran.r-project.org/package=here)
- [httr](https://cran.r-project.org/package=httr)
- [jsonlite](https://cran.r-project.org/package=jsonlite)

Make sure these packages are installed. You can install them by running:

```r
install.packages(c("here", "httr", "jsonlite"))
```

